#include "ac_bandpass_filter.hpp"

static const float32_t bandpassACCoeffs[ACBandpassFilter::kTotalTap] = {0.0006611310528f,0.0002960739366f,2.34649815e-05f,-0.0004150067107f,-0.0007977524074f,-0.0008763242513f,-0.0005304485676f,0.000130053988f,0.0007921875804f,0.001102252281f,0.0008748364053f,0.0002192851534f,-0.0005117042456f,-0.0009307296714f,-0.0008569461061f,-0.0004264315066f,8.340757631e-06f,0.0001376849395f,-6.500060408e-05f,-0.0002997606935f,-0.0001579877426f,0.0005332076689f,0.001480506966f,0.002011160133f,0.001476256293f,-0.0002417469077f,-0.00248448574f,-0.004042294342f,-0.00380735565f,-0.001498386497f,0.002008868381f,0.00500952825f,0.005852919538f,0.003895686707f,-4.162081314e-05f,-0.004038899671f,-0.006096720695f,-0.005242327228f,-0.002062122803f,0.001665714895f,0.00402718503f,0.004071423318f,0.002279441338f,0.0001213357536f,-0.0009884960018f,-0.0006403261796f,0.0003570799308f,0.0006452689413f,-0.0005885578576f,-0.002866597613f,-0.00458960142f,-0.004081243183f,-0.0008442772669f,0.00384408934f,0.007483954076f,0.007803936489f,0.004224325996f,-0.001626831596f,-0.006751622539f,-0.008513656445f,-0.006197394803f,-0.001395027735f,0.003046076279f,0.004846240394f,0.003691713559f,0.001273619011f,-6.439335993e-05f,0.0008596364059f,0.003079900285f,0.004094246775f,0.001749762916f,-0.003869426204f,-0.009949468076f,-0.01240031794f,-0.00849247165f,0.001001647208f,0.01169445738f,0.01782119274f,0.01561853848f,0.005762786139f,-0.006766106468f,-0.01547645312f,-0.01617727056f,-0.009425580502f,-9.803937218e-08f,0.006324764807f,0.006625183392f,0.002704490675f,-0.0003800994309f,0.001718435669f,0.008860912174f,0.01564168371f,0.01459909137f,0.001707036514f,-0.01942460239f,-0.0378674008f,-0.04086612538f,-0.02179441601f,0.01418290846f,0.05075028539f,0.06800255924f,0.05335594714f,0.009759339504f,-0.04392055795f,-0.08140235394f,-0.08240134269f,-0.04385427386f,0.01738064364f,0.07228841633f,0.09417223185f,0.07228841633f,0.01738064364f,-0.04385427386f,-0.08240134269f,-0.08140235394f,-0.04392055795f,0.009759339504f,0.05335594714f,0.06800255924f,0.05075028539f,0.01418290846f,-0.02179441601f,-0.04086612538f,-0.0378674008f,-0.01942460239f,0.001707036514f,0.01459909137f,0.01564168371f,0.008860912174f,0.001718435669f,-0.0003800994309f,0.002704490675f,0.006625183392f,0.006324764807f,-9.803937218e-08f,-0.009425580502f,-0.01617727056f,-0.01547645312f,-0.006766106468f,0.005762786139f,0.01561853848f,0.01782119274f,0.01169445738f,0.001001647208f,-0.00849247165f,-0.01240031794f,-0.009949468076f,-0.003869426204f,0.001749762916f,0.004094246775f,0.003079900285f,0.0008596364059f,-6.439335993e-05f,0.001273619011f,0.003691713559f,0.004846240394f,0.003046076279f,-0.001395027735f,-0.006197394803f,-0.008513656445f,-0.006751622539f,-0.001626831596f,0.004224325996f,0.007803936489f,0.007483954076f,0.00384408934f,-0.0008442772669f,-0.004081243183f,-0.00458960142f,-0.002866597613f,-0.0005885578576f,0.0006452689413f,0.0003570799308f,-0.0006403261796f,-0.0009884960018f,0.0001213357536f,0.002279441338f,0.004071423318f,0.00402718503f,0.001665714895f,-0.002062122803f,-0.005242327228f,-0.006096720695f,-0.004038899671f,-4.162081314e-05f,0.003895686707f,0.005852919538f,0.00500952825f,0.002008868381f,-0.001498386497f,-0.00380735565f,-0.004042294342f,-0.00248448574f,-0.0002417469077f,0.001476256293f,0.002011160133f,0.001480506966f,0.0005332076689f,-0.0001579877426f,-0.0002997606935f,-6.500060408e-05f,0.0001376849395f,8.340757631e-06f,-0.0004264315066f,-0.0008569461061f,-0.0009307296714f,-0.0005117042456f,0.0002192851534f,0.0008748364053f,0.001102252281f,0.0007921875804f,0.000130053988f,-0.0005304485676f,-0.0008763242513f,-0.0007977524074f,-0.0004150067107f,2.34649815e-05f,0.0002960739366f,0.0006611310528f};

static float32_t bandpassACStates[ACBandpassFilter::kTotalTap + ACBandpassFilter::kBlockSize];

ACBandpassFilter::ACBandpassFilter() {
  arm_fir_init_f32(&_firInstance, kTotalTap, (float32_t *)&bandpassACCoeffs[0], &bandpassACStates[0], kBlockSize);
}

void ACBandpassFilter::filter(const float32_t *input, float32_t *output) {
  arm_fir_f32(&_firInstance, input, output, kBlockSize);
}
