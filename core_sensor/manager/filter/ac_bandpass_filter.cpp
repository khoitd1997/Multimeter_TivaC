#include "ac_bandpass_filter.hpp"

static const float32_t bandpassACfilterCoeffs[ACBandpassFilter::kTotalTap] = {6.309313903e-05f,2.962047074e-05f,2.7344915e-05f,1.722768138e-05f,-1.107211006e-06f,-2.642819345e-05f,-5.585080362e-05f,-8.497830277e-05f,-0.0001085102122f,-0.0001210208866f,-0.0001180465115f,-9.702100215e-05f,-5.812965537e-05f,-4.596744475e-06f,5.740245251e-05f,0.0001195341247f,0.0001724118483f,0.0002072150382f,0.0002172204113f,0.0001992930775f,0.0001545960404f,8.875309868e-05f,1.099280689e-05f,-6.708570436e-05f,-0.000133659225f,-0.0001788202208f,-0.0001967705612f,-0.0001864533115f,-0.0001526945998f,-0.0001048888225f,-5.523455548e-05f,-1.643388532e-05f,1.499982886e-06f,-6.528882295e-06f,-3.877974814e-05f,-8.648562653e-05f,-0.000134877555f,-0.0001659452391f,-0.0001620324329f,-0.0001100498703f,-5.133138075e-06f,0.0001467256807f,0.0003280644596f,0.0005114604137f,0.0006633769954f,0.0007496083272f,0.0007416895824f,0.0006229701685f,0.0003933511907f,7.138659566e-05f,-0.0003066640056f,-0.0006910848897f,-0.00102570944f,-0.001256901189f,-0.001342589967f,-0.00126017502f,-0.001011666376f,-0.000624668668f,-0.0001493205491f,0.0003491186944f,0.0008004589472f,0.001141174347f,0.001325176796f,0.001331897685f,0.00117000693f,0.0008759539924f,0.0005073636421f,0.0001323671167f,-0.0001832782f,-0.0003888962674f,-0.0004589733435f,-0.0003985216899f,-0.0002424389386f,-4.873741273e-05f,0.000113320224f,0.000178117145f,9.879290883e-05f,-0.0001405382791f,-0.0005180455628f,-0.0009746793658f,-0.00142242026f,-0.001759215957f,-0.00188808341f,-0.001737235929f,-0.001277061878f,-0.0005307439715f,0.0004241976421f,0.001464354456f,0.002438029507f,0.003189407522f,0.003585222643f,0.00353924511f,0.003029935295f,0.002107713837f,0.0008899185341f,-0.0004562020767f,-0.001739963773f,-0.0027787406f,-0.003429017495f,-0.003611257765f,-0.00332384021f,-0.002643135376f,-0.001709326985f,-0.0007001344929f,0.0002028720191f,0.0008492015768f,0.001148924697f,0.001090816921f,0.0007451076526f,0.0002498378744f,-0.0002173561807f,-0.0004769835796f,-0.0003879359865f,0.0001176692895f,0.001012437162f,0.002169604646f,0.003379046451f,0.004381608684f,0.004916430451f,0.004772963934f,0.003838053206f,0.002128646942f,-0.0001971051533f,-0.002854083199f,-0.005468884483f,-0.007637521718f,-0.008992831223f,-0.009269896895f,-0.008357515559f,-0.006325646304f,-0.003422595561f,-4.092535528e-05f,0.003343226854f,0.006247707643f,0.008265522309f,0.009135037661f,0.008786106482f,0.007352811284f,0.005149265751f,0.002611741656f,0.0002166260092f,-0.001611146843f,-0.002582233632f,-0.002603106899f,-0.001799672027f,-0.00049777393f,0.0008379951469f,0.001697818865f,0.001636335859f,0.0003782504064f,-0.002101045568f,-0.005537496414f,-0.009394001216f,-0.0129314512f,-0.01532688085f,-0.01582109556f,-0.01387144066f,-0.009282461368f,-0.002288979013f,0.006427466869f,0.01579771936f,0.02449620515f,0.03112817369f,0.03444623575f,0.03356278688f,0.02812316455f,0.01840873808f,0.005348547827f,-0.009568344802f,-0.0244721286f,-0.03736051172f,-0.04638133571f,-0.05010797456f,-0.04776524752f,-0.03936965391f,-0.02575965971f,-0.008507817052f,0.01027573738f,0.02822207473f,0.04302532226f,0.05276110023f,0.05615493655f,0.05276110023f,0.04302532226f,0.02822207473f,0.01027573738f,-0.008507817052f,-0.02575965971f,-0.03936965391f,-0.04776524752f,-0.05010797456f,-0.04638133571f,-0.03736051172f,-0.0244721286f,-0.009568344802f,0.005348547827f,0.01840873808f,0.02812316455f,0.03356278688f,0.03444623575f,0.03112817369f,0.02449620515f,0.01579771936f,0.006427466869f,-0.002288979013f,-0.009282461368f,-0.01387144066f,-0.01582109556f,-0.01532688085f,-0.0129314512f,-0.009394001216f,-0.005537496414f,-0.002101045568f,0.0003782504064f,0.001636335859f,0.001697818865f,0.0008379951469f,-0.00049777393f,-0.001799672027f,-0.002603106899f,-0.002582233632f,-0.001611146843f,0.0002166260092f,0.002611741656f,0.005149265751f,0.007352811284f,0.008786106482f,0.009135037661f,0.008265522309f,0.006247707643f,0.003343226854f,-4.092535528e-05f,-0.003422595561f,-0.006325646304f,-0.008357515559f,-0.009269896895f,-0.008992831223f,-0.007637521718f,-0.005468884483f,-0.002854083199f,-0.0001971051533f,0.002128646942f,0.003838053206f,0.004772963934f,0.004916430451f,0.004381608684f,0.003379046451f,0.002169604646f,0.001012437162f,0.0001176692895f,-0.0003879359865f,-0.0004769835796f,-0.0002173561807f,0.0002498378744f,0.0007451076526f,0.001090816921f,0.001148924697f,0.0008492015768f,0.0002028720191f,-0.0007001344929f,-0.001709326985f,-0.002643135376f,-0.00332384021f,-0.003611257765f,-0.003429017495f,-0.0027787406f,-0.001739963773f,-0.0004562020767f,0.0008899185341f,0.002107713837f,0.003029935295f,0.00353924511f,0.003585222643f,0.003189407522f,0.002438029507f,0.001464354456f,0.0004241976421f,-0.0005307439715f,-0.001277061878f,-0.001737235929f,-0.00188808341f,-0.001759215957f,-0.00142242026f,-0.0009746793658f,-0.0005180455628f,-0.0001405382791f,9.879290883e-05f,0.000178117145f,0.000113320224f,-4.873741273e-05f,-0.0002424389386f,-0.0003985216899f,-0.0004589733435f,-0.0003888962674f,-0.0001832782f,0.0001323671167f,0.0005073636421f,0.0008759539924f,0.00117000693f,0.001331897685f,0.001325176796f,0.001141174347f,0.0008004589472f,0.0003491186944f,-0.0001493205491f,-0.000624668668f,-0.001011666376f,-0.00126017502f,-0.001342589967f,-0.001256901189f,-0.00102570944f,-0.0006910848897f,-0.0003066640056f,7.138659566e-05f,0.0003933511907f,0.0006229701685f,0.0007416895824f,0.0007496083272f,0.0006633769954f,0.0005114604137f,0.0003280644596f,0.0001467256807f,-5.133138075e-06f,-0.0001100498703f,-0.0001620324329f,-0.0001659452391f,-0.000134877555f,-8.648562653e-05f,-3.877974814e-05f,-6.528882295e-06f,1.499982886e-06f,-1.643388532e-05f,-5.523455548e-05f,-0.0001048888225f,-0.0001526945998f,-0.0001864533115f,-0.0001967705612f,-0.0001788202208f,-0.000133659225f,-6.708570436e-05f,1.099280689e-05f,8.875309868e-05f,0.0001545960404f,0.0001992930775f,0.0002172204113f,0.0002072150382f,0.0001724118483f,0.0001195341247f,5.740245251e-05f,-4.596744475e-06f,-5.812965537e-05f,-9.702100215e-05f,-0.0001180465115f,-0.0001210208866f,-0.0001085102122f,-8.497830277e-05f,-5.585080362e-05f,-2.642819345e-05f,-1.107211006e-06f,1.722768138e-05f,2.7344915e-05f,2.962047074e-05f,6.309313903e-05f};

static float32_t bandpassACStates[ACBandpassFilter::kTotalTap + ACBandpassFilter::kBlockSize];

ACBandpassFilter::ACBandpassFilter() {
  arm_fir_init_f32(&_firInstance, kTotalTap, (float32_t *)&bandpassACfilterCoeffs[0], &bandpassACStates[0], kBlockSize);
}

void ACBandpassFilter::filter(const float32_t input[kBlockSize] , float32_t output[kBlockSize] ) {
  arm_fir_f32(&_firInstance, (float32_t *)&input[0], (float32_t *)&output[0], kBlockSize);
}
